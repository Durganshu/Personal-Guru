{% extends "base.html" %}

{% block title %}Notes - {{ topic.name }}{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='notes.css') }}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
{% endblock %}

{% block content %}
<div class="notes-layout">
    <div class="notes-header">
        <div class="header-left">
            <a href="{{ url_for('main.index') }}" class="back-link"><i class="fas fa-arrow-left"></i> Back to Topics</a>
            <h1>{{ topic.name }} - Notebook</h1>
        </div>
        <div class="header-right">
            <span id="save-status" class="save-status">All changes saved</span>
            <button id="export-btn" class="button secondary" title="Download Notes">
                <i class="fas fa-download"></i> Export
            </button>
        </div>
    </div>

    <div class="notebook-container">
        <div class="notebook-spine"></div>
        <div class="notebook-page">
            <div class="toolbar">
                <div class="toolbar-group">
                    <button class="toolbar-btn" data-command="bold" title="Bold (Ctrl+B)"><i class="fas fa-bold"></i></button>
                    <button class="toolbar-btn" data-command="italic" title="Italic (Ctrl+I)"><i class="fas fa-italic"></i></button>
                    <button class="toolbar-btn" data-command="underline" title="Underline (Ctrl+U)"><i class="fas fa-underline"></i></button>
                    <button class="toolbar-btn" data-command="strikeThrough" title="Strikethrough"><i class="fas fa-strikethrough"></i></button>
                </div>
                <div class="toolbar-divider"></div>
                <div class="toolbar-group">
                    <button class="toolbar-btn" data-command="insertUnorderedList" title="Bullet List"><i class="fas fa-list-ul"></i></button>
                    <button class="toolbar-btn" data-command="insertOrderedList" title="Numbered List"><i class="fas fa-list-ol"></i></button>
                </div>
                <div class="toolbar-divider"></div>
                <div class="toolbar-group">
                    <select id="font-select" class="font-select" title="Font Family">
                        <option value="Inter, sans-serif">Sans Serif</option>
                        <option value="'Courier New', Courier, monospace">Monospace</option>
                        <option value="'Times New Roman', Times, serif">Serif</option>
                        <option value="'Dancing Script', cursive">Handwriting</option>
                    </select>
                </div>
            </div>

            <div class="editor-wrapper">
                <div id="notes-editor" class="notes-editor" contenteditable="true" placeholder="Start typing your notes here..."></div>
            </div>

            <div class="page-footer">
                Page 1
            </div>
        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='notes.js') }}"></script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        initNotes({
            topicName: "{{ topic.name | safe }}",
            csrfToken: "{{ csrf_token() }}",
            jweToken: "{{ jwe_token if jwe_token else '' }}"
        });
    });
</script>
{% endblock %}
