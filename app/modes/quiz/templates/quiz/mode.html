{% extends "base.html" %}

{% block title %}Quiz Mode - {{ topic_name }}{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('quiz.static', filename='quiz.css') }}">
{% endblock %}

{% block scripts %}
<script src="{{ url_for('quiz.static', filename='quiz.js') }}"></script>
<script src="{{ url_for('common.static', filename='js/time_tracker.js') }}"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        new TimeTracker({
            updateUrl: "{{ url_for('quiz.update_time', topic_name=topic_name) }}",
            topicName: "{{ topic_name }}"
        });
    });
</script>
{% endblock %}

{% block content %}
<div class="header-actions"
    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
    <h1>Quiz on {{ topic_name }}</h1>
    <form action="{{ url_for('quiz.reset_quiz', topic_name=topic_name) }}" method="post" style="margin: 0;"
        onsubmit="return confirm('Are you sure? This will delete your current quiz and start a new one.');">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <input type="hidden" name="jwe_token" value="{{ jwe_token if jwe_token else '' }}">
        <button type="submit" class="button secondary">Regenerate Quiz</button>
    </form>
</div>
<form method="post" action="{{ url_for('quiz.submit_quiz', topic_name=topic_name) }}"
    onsubmit="showLoader('Submitting your quiz...');">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
    <input type="hidden" name="jwe_token" value="{{ jwe_token if jwe_token else '' }}">
    {% for i in range(quiz_data.questions|length) %}
    {% set question_index = loop.index0 %}
    <div class="question">
        <h2>{{ quiz_data.questions[i].question }}</h2>
        <div class="options">
            {% for option in quiz_data.questions[i].options %}
            <div class="option">
                <label>
                    <input type="radio" name="answers_{{ question_index }}" value="{{ loop.index0 }}" required>
                    {{ option }}
                </label>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endfor %}
    <input type="submit" value="Submit Quiz" class="button">
</form>
{% endblock %}
